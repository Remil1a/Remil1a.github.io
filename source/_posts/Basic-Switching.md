---
title: Basic Switching
date: 2018-07-17 14:50:58
categories: Cisco
tags: [Cisco,Huawei,H3C]
---

# 交换机工作原理

以太网交换机，在不做特别说明的情况下，一般指的是二层交换机。这种设备工作在OSI参考模型的第二层。依靠二层消息中的源和目标转发数据，可以提供多个接口，让各种设备互相连接起来。

<!---more---->

交换机主要有三个功能

- 地址学习
- 帧的转发和过滤
- 环路防止



## 地址学习

![1](Basic-Switching\1.png)

首先在刚开机时，MAC地址表是空的。交换机依靠这张表转发数据。可是在刚开机时，这张表里没有任何信息。这里以思科的设备为例。在设备上使用show mac address-table查看mac地址表。

![2](Basic-Switching\2.png)



这张表根据设备的不同，存储条目的上限也有不同。交换机学习mac地址的过程如下：

假设主机A发送数据帧给主机C。会带着自己的源mac地址发送数据。这里先不管目标mac是多少，交换机会先从E0接口学习到一个条目。那就是E0接口连接的设备mac地址是0260.8c01.1111.这是由源地址学习过来的。那么交换机上的mac表这时会多一个条目，变成如下所示的样子。

![3](basic-switching\3.png)

但是这个时候给C的消息由于mac表中依然没有对应C的条目，所以这个时候交换机会做一个操作叫做泛洪。泛洪是指，当交换机收到未知的单播帧（目标mac地址在mac表中没有对应条目）时，将会把这个数据发送给除了收到这个帧的接口的所有接口，在图中，交换机会将从E0收到的未知单播帧发给E1，E2，E3。这样一来C一定会收到这个消息。C在回复A的时候由于之前已经记录过一次MAC地址，所以回复的帧不会泛洪，并且同时可以由E2学习到C的MAC地址。



![4](Basic-switching\4.png)

